<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Search</title>
    <link rel="stylesheet" href="style11.css">
</head>
<body>
    <div class="ctn">
        <div class="navbar">
            <div class="gambar"><img src="saung-removebg-preview.png" /></div>
            <div class="isinavbar">
                <a href="home.html">HOME</a>
                <a href="menu.html">MENU</a>
                <a href="pesanan.html">PESANAN</a>
            </div>
    </div>
    <div class="atas">
        <div class="toko">
            <p>SAUNG <br> BAHAGIA</p>
        </div>
        <form onsubmit="return searchProduct()">
            <input type="text" placeholder="Search..." class="search" id="searchInput">
            <button type="submit" class="search-btn">Search</button>
            <script>
            function searchProduct() {
                const keyword = document.getElementById("searchInput").value.toLowerCase();
                const products = document.querySelectorAll(".produk-card");

                let foundAny = false;

                // Filter produk berdasarkan keyword
                products.forEach(card => {
                    const name = card.querySelector("p").textContent.toLowerCase();
                    const match = name.includes(keyword);
                    card.style.display = match ? "block" : "none";
                    if (match) foundAny = true;
                });

                // Sembunyikan/tampilkan kategori kontainer
                const containers = document.querySelectorAll(".mie, .mie2, .camilan1, .camilan2, .camilan3, .camilan4, .minuman1, .minuman2, .minuman3, .minuman4");
                containers.forEach(container => {
                    const visibleProducts = container.querySelectorAll(".produk-card");
                    const hasVisible = Array.from(visibleProducts).some(card => card.style.display !== "none");
                    container.style.display = hasVisible ? "flex" : "none";
                });

                // Sembunyikan/tampilkan judul kategori
                const mieVisible = Array.from(document.querySelectorAll(".mie, .mie2")).some(c => c.style.display !== "none");
                document.querySelector(".h1").style.display = mieVisible ? "block" : "none";

                const camilanVisible = Array.from(document.querySelectorAll(".camilan1, .camilan2, .camilan3, .camilan4")).some(c => c.style.display !== "none");
                document.querySelector(".h2").style.display = camilanVisible ? "block" : "none";

                const minumanVisible = Array.from(document.querySelectorAll(".minuman1, .minuman2, .minuman3, .minuman4")).some(c => c.style.display !== "none");
                document.querySelector(".h3").style.display = minumanVisible ? "block" : "none";

                // Tampilkan/ sembunyikan pesan "Produk tidak ditemukan"
                document.getElementById("not-found").style.display = foundAny ? "none" : "block";

                return false; // Mencegah reload halaman
            }
</script>   
    </form>
    <div class="keranjang">
        <a href="keranjang.html">
            <img src="keranjang-removebg-preview.png" alt="Keranjang">
            <span class="nomor" id="cart-count">0</span>
        </a>
        <script>
            window.onload = function() {
              fetch('get_keranjang.php')
                .then(res => res.json())
                .then(data => {
                  document.getElementById("keranjang-jumlah").innerText = data.total;
                })
                .catch(err => {
                  console.error('Gagal ambil data keranjang:', err);
                });
            };
            </script>
    </div>
    
        </div>
    <div class="h1">
    <h1>MIE</h1>
    </div>
        <div class="mie">
        <div class="satu produk-card">
            <img src="contoh.jpg">
            <p>Mie Kangen</p>
            <div class="bawah">
            <p>Rp 10.000</p>
            <a href="indexmiekangen.html"><button>Tambah</button></a>
            </div>
        </div>
        <div class="dua produk-card">
            <img src="contoh.jpg">
            <p>Mie Happy</p>
            <div class="bawah2">
            <p>Rp 10.000</p>
            <a href="indexmiehappy.html"><button>Tambah</button></a>
            </div>
        </div>
    </div>
    <div class="mie2">
        <div class="tiga produk-card">
            <img src="contoh.jpg">
            <p>Mie Angel</p>
            <div class="bawah3">
            <p>Rp 10.000</p>
            <a href="indexmieangel.html"><button>Tambah</button></a>
            </div>
        </div>
        <div class="empat produk-card">
            <img src="contoh.jpg">
            <p>Mie Jebew</p>
            <div class="bawah4">
            <p>Rp 10.000</p>
            <a href="indexmiejebew.html"><button>Tambah</button></a>
            </div>
        </div>
    </div>
    <div class="h2">
        <h2>CAMILAN</h2>
        </div>
            <div class="camilan1">
            <div class="pertama produk-card">
                <img src="contoh.jpg">
                <p>Dimsum Ayam</p>
                <div class="bawah11">
                <p>Rp 6.000</p>
                <button>Tambah</button>
                </div>
            </div>
            <div class="kedua produk-card">
                <img src="contoh.jpg">
                <p>Udang Keju</p>
                <div class="bawah22">
                <p>Rp 6.000</p>
                <button>Tambah</button>
                </div>
            </div>
        </div>
        <div class="camilan2">
            <div class="ketiga produk-card">
                <img src="contoh.jpg">
                <p>Udang Rambutan</p>
                <div class="bawah33">
                <p>Rp 6.000</p>
                <button>Tambah</button>
                </div>
            </div>
            <div class="keempat produk-card">
                <img src="contoh.jpg">
                <p>Pangsit</p>
                <div class="bawah44">
                <p>Rp 6.000</p>
                <button>Tambah</button>
                </div>
            </div>
        </div>
        <div class="camilan3">
            <div class="kelima produk-card">
                <img src="contoh.jpg">
                <p>Sosis Goreng</p>
                <div class="bawah5">
                <p>Rp 5.000</p>
                <button>Tambah</button>
                </div>
            </div>
            <div class="keenam produk-card">
                <img src="contoh.jpg">
                <p>Nugget Goreng</p>
                <div class="bawah6">
                <p>Rp 5.000</p>
                <button>Tambah</button>
                </div>
            </div>
        </div>
        <div class="camilan4">
            <div class="ketujuh produk-card">
                <img src="contoh.jpg">
                <p>Cireng</p>
                <div class="bawah7">
                <p>Rp 5.000</p>
                <button>Tambah</button>
                </div>
            </div>
        </div>
        <div class="h3" data-kategori="minuman">
            <h3>MINUMAN</h3>
            </div>
                <div class="minuman1">
                <div class="one produk-card">
                    <img src="contoh.jpg">
                    <p>Es Teh</p>
                    <div class="bawahh1">
                    <p>Rp 3.000</p>
                    <button>Tambah</button>
                    </div>
                </div>
                <div class="two produk-card">
                    <img src="contoh.jpg">
                    <p>Es Nutrisari</p>
                    <div class="bawahh2">
                    <p>Rp 3.000</p>
                    <button>Tambah</button>
                    </div>
                </div>
            </div>
            <div class="minuman2">
                <div class="three produk-card">
                    <img src="contoh.jpg">
                    <p>Es Taro</p>
                    <div class="bawahh3">
                    <p>Rp 6.000</p>
                    <button>Tambah</button>
                    </div>
                </div>
                <div class="four produk-card">
                    <img src="contoh.jpg">
                    <p>Es Redvelvet</p>
                    <div class="bawahh4">
                    <p>Rp 6.000</p>
                    <button>Tambah</button>
                    </div>
                </div>
            </div>
            <div class="minuman3">
                <div class="five produk-card">
                    <img src="contoh.jpg">
                    <p>Es Grentea matcha</p>
                    <div class="bawahh5">
                    <p>Rp 6.000</p>
                    <button>Tambah</button>
                    </div>
                </div>
                <div class="six produk-card">
                    <img src="contoh.jpg">
                    <p>Es Coklat</p>
                    <div class="bawahh6">
                    <p>Rp 6.000</p>
                    <button>Tambah</button>
                    </div>
                </div>
            </div>
            <div class="minuman4">
                <div class="seven produk-card">
                    <img src="contoh.jpg">
                    <p>Es Cappucino</p>
                    <div class="bawahh7">
                    <p>Rp 6.000</p>
                    <button>Tambah</button>
                    </div>
                </div>
            </div>
            <div id="not-found" style="display:none; text-align:center; margin-top:20px;">
                <p>Produk tidak ditemukan.</p>
              </div>
              
    </div>
    <script>
        let cart = [];

        // Fungsi untuk memperbarui jumlah produk di keranjang
        function updateCartCount() {
            const countElement = document.getElementById("cart-count");
            countElement.textContent = cart.length;
        }

        // Fungsi untuk menambah produk ke keranjang
        function handleAddToCart(event) {
            const button = event.target;
            const card = button.closest('.produk-card');
            const productName = card.querySelector('p').textContent.trim();
            const productPrice = card.querySelector('.bawah p, .bawah2 p, .bawah3 p, .bawah4 p, .bawah11 p, .bawah22 p, .bawah33 p, .bawah44 p, .bawah5 p, .bawah6 p, .bawah7 p, .bawahh1 p, .bawahh2 p, .bawahh3 p, .bawahh4 p, .bawahh5 p, .bawahh6 p, .bawahh7 p').textContent.trim();

            cart.push({ name: productName, price: productPrice });
            updateCartCount(); // Memperbarui jumlah cart
            animateToCart(card); // Animasi (opsional)
        }

        // Fungsi pencarian produk
        function searchProduct() {
            const keyword = document.getElementById("searchInput").value.toLowerCase();
            const products = document.querySelectorAll(".produk-card");

            let foundAny = false;

            // Menyaring produk berdasarkan keyword pencarian
            products.forEach(card => {
                const name = card.querySelector("p").textContent.toLowerCase();
                const match = name.includes(keyword);
                card.style.display = match ? "block" : "none";
                if (match) foundAny = true;
            });

            // Menyembunyikan atau menampilkan kategori produk
            const containers = document.querySelectorAll(".mie, .mie2, .camilan1, .camilan2, .camilan3, .camilan4, .minuman1, .minuman2, .minuman3, .minuman4");
            containers.forEach(container => {
                const visibleProducts = container.querySelectorAll(".produk-card");
                const hasVisible = Array.from(visibleProducts).some(card => card.style.display !== "none");
                container.style.display = hasVisible ? "flex" : "none";
            });

            // Menampilkan atau menyembunyikan judul kategori
            document.querySelector(".h1").style.display = document.querySelector(".mie").style.display !== "none" ? "block" : "none";
            document.querySelector(".h2").style.display = document.querySelector(".camilan1").style.display !== "none" ? "block" : "none";
            document.querySelector(".h3").style.display = document.querySelector(".minuman1").style.display !== "none" ? "block" : "none";

            // Menampilkan atau menyembunyikan pesan "Produk tidak ditemukan"
            document.getElementById("not-found").style.display = foundAny ? "none" : "block";

            return false; // Mencegah reload halaman
        }

        // Gabungkan semua inisialisasi dalam satu event listener 'DOMContentLoaded'
        document.addEventListener("DOMContentLoaded", function () {
            // Menambahkan event listener untuk tombol "Tambah ke keranjang"
            const buttons = document.querySelectorAll(".produk-card button");
            buttons.forEach(button => {
                button.addEventListener("click", handleAddToCart);
            });

            // Mengupdate jumlah keranjang
            updateCartCount();

            // Ambil data keranjang dari server (opsional)
            fetch("get_keranjang.php")
                .then(response => response.json())
                .then(data => {
                    document.getElementById("cart-count").textContent = data.total;
                })
                .catch(error => {
                    console.error("Gagal mengambil data keranjang:", error);
        });
    });
</script>         
</body>
</html>